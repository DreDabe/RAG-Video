针对你提出的布局平衡和按钮交互优化需求，我分析了当前的 QML 结构。问题在于两个 `ColumnLayout` 都试图通过 `Layout.fillHeight: true` 均分空间，而没有设置权重，且按钮逻辑过于分散。

以下是修改建议和参考代码：

### 一、 修改建议描述

1.  **高度权重重新分配**：
    *   将 **Cookie 输入框** 的容器高度固定或设置为较小的建议高度（如 `Layout.preferredHeight: 150`），并移除其 `Layout.fillHeight`，防止其随内容无限膨胀。
    *   保持 **运行日志** 容器的 `Layout.fillHeight: true`。这样日志框会自动占据界面中除去输入框后剩下的所有空间（通常会占据 70% 以上），视觉上主次分明。
2.  **状态切换按钮 (Stateful Button)**：
    *   将两个按钮合并为一个动态按钮。
    *   **文字切换**：利用三元表达式，根据 `isRunning` 状态显示“开始更新知识库”或“停止更新”。
    *   **颜色切换**：正常状态下为深灰色（Zinc 风格），运行状态下变为红色（警示风格）。
    *   **逻辑合并**：在 `onClicked` 中判断当前状态，决定调用 `start_update()` 还是 `stop_update()`。

---

### 二、 参考代码实现

请将 `main.qml` 中 `// ================== 视图 3: 更新知识库界面 (优化版) ==================` 部分的代码替换为以下内容：

```qml
        // ================== 视图 3: 更新知识库界面 (布局与交互优化版) ==================
        Item {
            id: updateView
            anchors.fill: parent
            visible: activeView === "update"

            // 增加一个内部状态属性，确保 UI 响应更及时
            property bool isRunning: knowledgeUpdater ? knowledgeUpdater.is_running_status() : false

            Component.onCompleted: {
                Qt.callLater(function() {
                    platformCombo.currentIndex = platformCombo.find(configManager.get_knowledge_platform())
                    typeCombo.currentIndex = typeCombo.find(configManager.get_knowledge_type())
                    urlField.text = configManager.get_knowledge_url()
                    cookieField.text = configManager.get_knowledge_cookie()
                })
            }

            Connections {
                target: knowledgeUpdater
                function onLogUpdated(message) {
                    logArea.text += "\n" + message
                    logArea.cursorPosition = logArea.text.length
                }
                function onUpdateStarted() { updateView.isRunning = true }
                function onUpdateStopped() { updateView.isRunning = false }
                function onUpdateFinished() { updateView.isRunning = false }
            }

            ColumnLayout {
                anchors.fill: parent
                anchors.margins: 40
                anchors.topMargin: 30
                spacing: 16

                Text { 
                    text: "更新知识库"
                    color: "white"
                    font.pixelSize: 24
                    font.weight: Font.Bold
                    Layout.bottomMargin: 10
                }

                // 视频平台与类型行 (保持不变)
                RowLayout {
                    Layout.fillWidth: true
                    spacing: 20
                    ColumnLayout {
                        Layout.fillWidth: true
                        Layout.preferredWidth: 1
                        spacing: 8
                        Text { text: "视频平台"; color: "#a1a1aa"; font.pixelSize: 12 }
                        ComboBox { 
                            id: platformCombo
                            model: ["Bilibili"]
                            Layout.fillWidth: true
                            Layout.preferredHeight: 40
                            onActivated: configManager.set_knowledge_platform(currentText)
                            // ... 样式略 (同原代码) ...
                        }
                    }
                    ColumnLayout {
                        Layout.fillWidth: true
                        Layout.preferredWidth: 1
                        spacing: 8
                        Text { text: "类型"; color: "#a1a1aa"; font.pixelSize: 12 }
                        ComboBox { 
                            id: typeCombo
                            model: ["视频", "收藏夹"]
                            Layout.fillWidth: true
                            Layout.preferredHeight: 40
                            onActivated: configManager.set_knowledge_type(currentText)
                            // ... 样式略 (同原代码) ...
                        }
                    }
                }

                // 地址 URL 行
                ColumnLayout {
                    Layout.fillWidth: true
                    spacing: 8
                    Text { text: "地址（URL）"; color: "#a1a1aa"; font.pixelSize: 12 }
                    TextField { 
                        id: urlField
                        Layout.fillWidth: true
                        Layout.preferredHeight: 40
                        color: "white"
                        font.pixelSize: 13
                        onTextChanged: configManager.set_knowledge_url(text)
                        background: Rectangle {
                            color: "#09090b"
                            radius: 8
                            border.color: parent.activeFocus ? "#3b82f6" : "#27272a"
                            border.width: parent.activeFocus ? 2 : 1
                        }
                    }
                }

                // 1. Cookie 输入框 (设置为较小的高度，不自动填充剩余高度)
                ColumnLayout {
                    Layout.fillWidth: true
                    Layout.preferredHeight: 120 // 设置一个固定的舒适高度
                    spacing: 8
                    Text { text: "Cookie (用于平台授权)"; color: "#a1a1aa"; font.pixelSize: 12 }
                    ScrollView {
                        Layout.fillWidth: true
                        Layout.fillHeight: true
                        TextArea {
                            id: cookieField
                            placeholderText: "粘贴视频平台 Cookie 于此..."
                            color: "white"
                            font.family: "Consolas, Monospace"
                            font.pixelSize: 13
                            onTextChanged: configManager.set_knowledge_cookie(text)
                            background: Rectangle { color: "#18181b"; radius: 8; border.color: "#27272a" }
                            wrapMode: TextArea.Wrap
                        }
                    }
                }

                // 2. 运行日志 (设置为 fillHeight，它将占据所有剩下的空间)
                ColumnLayout {
                    Layout.fillWidth: true
                    Layout.fillHeight: true // 核心改动：使其占据主导地位
                    spacing: 8
                    Text { text: "运行日志"; color: "#a1a1aa"; font.pixelSize: 12 }
                    Rectangle {
                        Layout.fillWidth: true
                        Layout.fillHeight: true
                        color: "#000000"
                        radius: 8
                        border.color: "#1d1d20"
                        ScrollView {
                            anchors.fill: parent
                            anchors.margins: 10
                            TextArea {
                                id: logArea
                                readOnly: true
                                text: "> 等待任务启动...\n> 准备更新知识库..."
                                color: "#10b981"
                                font.family: "Consolas, Monospace"
                                font.pixelSize: 12
                                background: null
                            }
                        }
                    }
                }

                // 3. 合二为一的状态按钮
                Button {
                    id: toggleUpdateBtn
                    Layout.alignment: Qt.AlignHCenter
                    Layout.preferredWidth: 320
                    Layout.preferredHeight: 48
                    Layout.topMargin: 10
                    Layout.bottomMargin: 10

                    // 动态文本
                    contentItem: Text {
                        text: updateView.isRunning ? "停止更新任务" : "开始更新知识库"
                        color: "white"
                        font.weight: Font.Medium
                        font.pixelSize: 16
                        horizontalAlignment: Text.AlignHCenter
                        verticalAlignment: Text.AlignVCenter
                    }

                    // 动态背景色
                    background: Rectangle {
                        // 运行中显示红色，平时显示黑灰色
                        color: updateView.isRunning 
                               ? (toggleUpdateBtn.hovered ? "#ef4444" : "#dc2626") 
                               : (toggleUpdateBtn.hovered ? "#3f3f46" : "#27272a")
                        radius: 10
                        border.color: updateView.isRunning ? "#ef4444" : "#3f3f46"
                        border.width: 1
                        Behavior on color { ColorAnimation { duration: 250 } }
                    }

                    onClicked: {
                        if (updateView.isRunning) {
                            knowledgeUpdater.stop_update()
                        } else {
                            // 清除旧日志开始新任务
                            logArea.text = "> 任务启动中..."
                            knowledgeUpdater.start_update()
                        }
                    }
                }
            }
        }
```

### 修改要点总结：

1.  **高度平衡**：通过显式设置 Cookie 框的 `Layout.preferredHeight` 为 `120`，并移除其 `Layout.fillHeight`，解决了它在输入长内容时“霸占”屏幕的问题。日志框现在会占据绝大部分空间。
2.  **交互简化**：新的 `toggleUpdateBtn` 将开始/停止逻辑闭环。通过颜色（红色 vs 灰色）给用户极其明确的状态指示。
3.  **日志逻辑微调**：在点击“开始”时清空或重置 `logArea`，提升了“开始新任务”的仪式感。