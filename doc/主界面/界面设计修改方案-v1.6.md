针对你提出的三个问题，我分析了代码逻辑并提供了精准的修复方案。

### 1. 侧边栏图标消失问题分析
**原因：** 在 `SidebarButton` 组件模板中，你定义了两个 `Image` 控件，一个绑定 `expandIconSource`（展开时显示），一个绑定 `collapseIconSource`（收缩时显示）。在“新建对话”和“设置”按钮的实例中，你只给前者赋了值，而后者为空，导致收缩时没有图标路径可显示。

### 2. 双击标题栏逻辑及拖动还原问题分析
**原因：** 之前的双击逻辑混合使用了系统属性 `window.visibility` 和自定义属性 `window.windowMaximized`，在无边框模式下容易产生同步延迟。拖动还原功能需要监听鼠标在最大化状态下的位移。

---

### 修改后的参考代码

请根据以下描述替换 `main.qml` 中的对应部分：

#### 修复问题 1：侧边栏按钮（仅修改新建和设置按钮实例）
在实例中补充 `collapseIconSource` 属性。

```qml
            // 2. 新建按钮
            SidebarButton {
                iconSource: "img/新建.svg"
                expandIconSource: "img/新建.svg"
                collapseIconSource: "img/新建.svg" // 补充收缩时的图标
                labelText: "新建对话"
                isAccent: true
            }

            // ... (ListView部分保持不变) ...

            // 4. 设置按钮 (底部)
            SidebarButton {
                iconSource: "img/设置.svg"
                expandIconSource: "img/设置.svg"
                collapseIconSource: "img/设置.svg" // 补充收缩时的图标
                labelText: "设置"
            }
```

#### 修复问题 2 & 3：标题栏交互（仅修改 titleBar 内部的 MouseArea）
通过监听鼠标位置实现拖拽还原，并统一双击逻辑。

```qml
        MouseArea {
            id: titleBarMouseArea
            anchors.fill: parent
            
            // 处理普通拖动
            onPressed: {
                if (!window.windowMaximized) {
                    window.startSystemMove()
                }
            }

            // 处理最大化下的拖动还原
            onPositionChanged: {
                if (pressed && window.windowMaximized) {
                    // 如果在最大化状态下发生拖拽，先还原窗口
                    window.showNormal()
                    window.windowMaximized = false
                    // 然后立即触发系统拖动
                    window.startSystemMove()
                }
            }

            // 修复双击逻辑：使用自定义属性作为唯一判断标准
            onDoubleClicked: {
                if (window.windowMaximized) {
                    window.showNormal()
                    window.windowMaximized = false
                } else {
                    window.showMaximized()
                    window.windowMaximized = true
                }
            }
        }
```

### 改进说明：
1.  **图标修复**：通过为“新建对话”和“设置”按钮显式指定 `collapseIconSource`，解决了收缩状态下 Image 路径为空的问题。
2.  **双击响应**：将双击逻辑完全绑定到 `window.windowMaximized`。由于这个属性在点击瞬间就被修改，QML 的属性绑定会立即触发窗口状态切换，解决了“需要多点一下”的迟钝感。
3.  **拖动还原**：在 `onPositionChanged` 中判断 `pressed && windowMaximized`。当检测到用户在最大化时试图移动鼠标，程序会先执行 `showNormal()`（这会让窗口回到鼠标点击前的相对位置），随后调用 `startSystemMove()` 接管后续的移动操作，实现无缝拖拽还原。