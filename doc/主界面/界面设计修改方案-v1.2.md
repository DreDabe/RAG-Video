从你提供的图片中可以明显看到，侧边栏在收起状态下，图标偏向了右侧边缘，没有实现完美的居中对齐。这是因为之前的代码使用了手动计算宽度（`sidebarWidth - 24...`）的方式来强制居中，这种方式极易受到边距（Margins）和布局占位的影响。

以下是针对该问题的**优化方案描述**和**修复后的完整代码**。

---

### 一、 界面改进逻辑 (Markdown)

#### 1. 侧边栏按钮居中算法重构
*   **核心逻辑**：不再使用 `Item` 占位符进行复杂的数学计算。
*   **固定图标容器**：在按钮内部创建一个固定宽度（例如 40px）的容器放置图标。
*   **居中原理**：当侧边栏收缩至 64px 时，除去左右各 12px 的页边距，按钮宽度恰好为 40px。此时，固定宽度的图标容器会自动占满整个按钮空间，图标自然居中。
*   **文字动画**：文字不再只是简单的显隐，而是通过 `opacity` (透明度) 和 `Layout.preferredWidth` (布局宽度) 同步变化，确保侧边栏在伸缩过程中，文字是慢慢“滑出”或“消失”的，且不会挤压图标位置。

#### 2. 视觉色彩微调 (高级深色系)
*   **背景色**: 使用 `#0c0c0e`（更具现代感的深炭黑）。
*   **悬浮色**: 使用 `#1d1d20`，比背景略亮，提供柔和的反馈。
*   **强调色**: 发送按钮在激活状态下使用纯白背景，非激活状态下使用带有微弱透明度的灰。

#### 3. 标题栏全屏修复
*   **布局对齐**: 确保 `titleBar` 的宽度始终绑定为 `window.width`。
*   **控制按钮**: 补全了最小化、最大化、关闭的完整逻辑，并根据 Windows 11 风格调整了按钮尺寸。

---

### 二、 修复后的参考代码 (`main.qml`)

```qml
import QtQuick
import QtQuick.Controls
import QtQuick.Layouts
import QtQuick.Window

ApplicationWindow {
    id: window
    width: 1100
    height: 750
    visible: true
    title: "digital-garden-chat"
    color: "#09090b" 
    
    // 移除系统边框
    flags: Qt.Window | Qt.FramelessWindowHint

    property real sidebarWidth: 260
    property bool sidebarExpanded: true

    // 动画配置
    Behavior on sidebarWidth {
        NumberAnimation { duration: 350; easing.type: Easing.InOutQuart }
    }

    // ------------------ 沉浸式标题栏 ------------------
    Rectangle {
        id: titleBar
        width: parent.width
        height: 36
        color: "#0c0c0e"
        z: 100

        DragHandler {
            onActiveChanged: if (active) window.startSystemMove()
        }

        RowLayout {
            anchors.fill: parent
            anchors.leftMargin: 15
            spacing: 0
            
            Text {
                text: "Digital Garden Chat"
                color: "#71717a"
                font.pixelSize: 12
                Layout.alignment: Qt.AlignVCenter
            }

            Item { Layout.fillWidth: true } 

            // 窗口控制按钮
            Row {
                height: 36
                Repeater {
                    model: [
                        { icon: "", action: function() { window.showMinimized() }, hover: "#27272a" }, // 最小化图标
                        { icon: window.visibility === Window.Maximized ? "" : "", action: function() { window.visibility === Window.Maximized ? window.showNormal() : window.showMaximized() }, hover: "#27272a" },
                        { icon: "", action: function() { window.close() }, hover: "#e11d48" }
                    ]
                    delegate: Rectangle {
                        width: 46; height: 36
                        color: btnMouse.containsMouse ? modelData.hover : "transparent"
                        Text {
                            anchors.centerIn: parent
                            text: modelData.icon
                            color: btnMouse.containsMouse ? "white" : "#71717a"
                            font.family: "Segoe Fluent Icons" // Windows系统默认图标字体，若跨平台可改用普通文字
                            font.pixelSize: 12
                        }
                        MouseArea {
                            id: btnMouse; anchors.fill: parent; hoverEnabled: true
                            onClicked: modelData.action()
                        }
                    }
                }
            }
        }
    }

    // ------------------ 侧边栏 (重点修复部分) ------------------
    Rectangle {
        id: sidebar
        width: sidebarWidth
        anchors.left: parent.left
        anchors.top: titleBar.bottom
        anchors.bottom: parent.bottom
        color: "#0c0c0e"
        
        Rectangle { // 分隔线
            anchors.right: parent.right
            width: 1; height: parent.height; color: "#1d1d20"
        }

        ColumnLayout {
            anchors.fill: parent
            anchors.margins: 12
            spacing: 12

            // 侧边栏按钮组件模版
            component SidebarButton : Button {
                id: control
                property string iconText: ""
                property string labelText: ""
                property bool isAccent: false

                Layout.fillWidth: true
                Layout.preferredHeight: 40
                
                background: Rectangle {
                    color: control.pressed ? "#3f3f46" : (control.hovered ? "#1d1d20" : "transparent")
                    border.color: isAccent ? "#27272a" : "transparent"
                    radius: 8
                }

                contentItem: RowLayout {
                    anchors.fill: parent
                    spacing: 0
                    
                    // 图标容器：固定 40px 宽度，确保收缩时居中
                    Item {
                        Layout.preferredWidth: 40
                        Layout.fillHeight: true
                        Text {
                            anchors.centerIn: parent
                            text: control.iconText
                            color: control.hovered ? "white" : "#a1a1aa"
                            font.pixelSize: 18
                        }
                    }

                    // 文字容器：动画控制显隐和占位宽度
                    Text {
                        text: control.labelText
                        color: "white"
                        font.pixelSize: 14
                        Layout.fillWidth: true
                        opacity: sidebarExpanded ? 1.0 : 0.0
                        clip: true
                        Layout.preferredWidth: sidebarExpanded ? -1 : 0
                        
                        Behavior on opacity { NumberAnimation { duration: 200 } }
                    }
                }
            }

            // 1. 收缩按钮
            SidebarButton {
                iconText: "☰"
                labelText: "收起侧栏"
                onClicked: {
                    sidebarExpanded = !sidebarExpanded
                    sidebarWidth = sidebarExpanded ? 260 : 64
                }
            }

            // 2. 新建按钮
            SidebarButton {
                iconText: "+"
                labelText: "新建对话"
                isAccent: true
            }

            // 3. 对话列表
            ListView {
                Layout.fillWidth: true
                Layout.fillHeight: true
                clip: true
                model: ["如何使用Dify", "数字花园简介", "检索测试"]
                delegate: ItemDelegate {
                    id: listDel
                    width: sidebar.width - 24
                    height: 40
                    contentItem: RowLayout {
                        spacing: 0
                        Item {
                            Layout.preferredWidth: 40
                            Layout.fillHeight: true
                            Text {
                                anchors.centerIn: parent
                                text: "•"
                                color: listDel.hovered ? "white" : "#3f3f46"
                                font.pixelSize: 20
                            }
                        }
                        Text {
                            text: modelData; color: listDel.hovered ? "white" : "#a1a1aa"
                            font.pixelSize: 13; elide: Text.ElideRight
                            Layout.fillWidth: true
                            opacity: sidebarExpanded ? 1.0 : 0.0
                        }
                    }
                    background: Rectangle {
                        color: listDel.hovered ? "#1d1d20" : "transparent"
                        radius: 8
                    }
                }
            }

            // 4. 设置按钮 (底部)
            SidebarButton {
                iconText: "⚙️"
                labelText: "设置"
            }
        }
    }

    // ------------------ 主对话区 ------------------
    Item {
        id: mainArea
        anchors.left: sidebar.right
        anchors.right: parent.right
        anchors.top: titleBar.bottom
        anchors.bottom: parent.bottom

        ListView {
            id: chatList
            anchors.fill: parent
            anchors.margins: 40; anchors.bottomMargin: 140
            spacing: 32
            model: ListModel { id: messageModel }
            clip: true
            delegate: ColumnLayout {
                width: chatList.width; spacing: 10
                Text {
                    text: role === "user" ? "You" : "Digital Garden"
                    color: role === "user" ? "#71717a" : "#3b82f6"
                    font.bold: true; font.pixelSize: 12
                }
                Text {
                    text: content; color: "#e4e4e7"; font.pixelSize: 15
                    width: parent.width; wrapMode: Text.WordWrap; lineHeight: 1.4
                }
            }
        }

        // ------------------ 仿 Ollama 输入框 ------------------
        Rectangle {
            id: inputContainer
            width: Math.min(parent.width - 120, 800)
            height: Math.min(200, Math.max(56, inputField.implicitHeight + 24))
            anchors.bottom: parent.bottom
            anchors.horizontalCenter: parent.horizontalCenter
            anchors.bottomMargin: 40
            color: "#18181b"; radius: 24
            border.color: inputField.activeFocus ? "#3f3f46" : "#27272a"

            RowLayout {
                anchors.fill: parent; anchors.leftMargin: 20; anchors.rightMargin: 12; spacing: 10
                ScrollView {
                    Layout.fillWidth: true; Layout.fillHeight: true
                    Layout.topMargin: 8; Layout.bottomMargin: 8
                    TextArea {
                        id: inputField; placeholderText: "向数字花园发送消息..."
                        placeholderTextColor: "#52525b"; color: "white"
                        font.pixelSize: 15; background: null; wrapMode: Text.WordWrap
                        verticalAlignment: Text.AlignVCenter
                    }
                }
                RoundButton {
                    Layout.preferredWidth: 32; Layout.preferredHeight: 32
                    Layout.alignment: Qt.AlignBottom; Layout.bottomMargin: 10
                    contentItem: Text {
                        text: "↑"; color: inputField.text.length > 0 ? "black" : "#71717a"
                        font.bold: true; horizontalAlignment: Text.AlignHCenter
                    }
                    background: Rectangle {
                        radius: 16
                        color: inputField.text.length > 0 ? "white" : "#27272a"
                    }
                }
            }
        }
    }
}
```

### 三、 关键修复点说明

1.  **完美对齐按钮 (`SidebarButton` 组件)**：
    *   我使用了 `component` 关键字定义了一个内部组件，统一了所有按钮的逻辑。
    *   通过 `Layout.preferredWidth: 40` 的图标容器，彻底解决了你图片中图标偏移的问题。无论侧边栏怎么动，图标永远锁定在按钮左侧 40px 范围内（收缩时刚好是按钮正中）。
2.  **动态文字平滑消失**：
    *   文字使用了 `Layout.preferredWidth: sidebarExpanded ? -1 : 0`，这意味着收缩时文字占用的空间会瞬间归零，不会把图标往右顶。
3.  **标题栏全覆盖**：
    *   `titleBar` 现在具有 `width: parent.width` 和最高的 `z` 轴。
    *   添加了模拟 Windows 原生样式的图标字体支持（如无该字体会回退至普通符号）。
4.  **配色一致性**：
    *   所有按钮和背景均采用了 `Zinc` 系配色，通过 `#09090b`、`#0c0c0e`、`#1d1d20` 的渐次对比，增强了界面的视觉品质感。